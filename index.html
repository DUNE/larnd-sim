

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Welcome to larnd-sim’s documentation! &mdash; larnd-sim 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> larnd-sim
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Welcome to larnd-sim’s documentation!</a><ul>
<li><a class="reference internal" href="#module-larndsim.quenching">Quenching stage</a></li>
<li><a class="reference internal" href="#module-larndsim.drifting">Drifting stage</a></li>
<li><a class="reference internal" href="#module-larndsim.detsim">Detector simulation stage</a></li>
<li><a class="reference internal" href="#module-larndsim.pixels_from_track">Pixel finder utility</a></li>
<li><a class="reference internal" href="#electronics-module">Electronics module</a></li>
<li><a class="reference internal" href="#module-larndsim.consts">Constants</a></li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</div>
            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">larnd-sim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>Welcome to larnd-sim’s documentation!</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="welcome-to-larnd-sim-s-documentation">
<h1>Welcome to larnd-sim’s documentation!<a class="headerlink" href="#welcome-to-larnd-sim-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="module-larndsim.quenching">
<span id="quenching-stage"></span><h2>Quenching stage<a class="headerlink" href="#module-larndsim.quenching" title="Permalink to this headline">¶</a></h2>
<p>Module to implement the quenching of the ionized electrons
through the detector</p>
<dl class="function">
<dt id="larndsim.quenching.quench">
<code class="sig-prename descclassname">larndsim.quenching.</code><code class="sig-name descname">quench</code><span class="sig-paren">(</span><em class="sig-param">tracks</em>, <em class="sig-param">mode</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.quenching.quench" title="Permalink to this definition">¶</a></dt>
<dd><p>This CUDA kernel takes as input an array of track segments and calculates
the number of electrons that reach the anode plane after recombination.
It is possible to pick among two models: Box (Baller, 2013 JINST 8 P08005) or
Birks (Amoruso, et al NIM A 523 (2004) 275).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tracks</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array containing the tracks segment information</p></li>
<li><p><strong>mode</strong> (<em>int</em>) – recombination model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-larndsim.drifting">
<span id="drifting-stage"></span><h2>Drifting stage<a class="headerlink" href="#module-larndsim.drifting" title="Permalink to this headline">¶</a></h2>
<p>Module to implement the propagation of the
electrons towards the anode.</p>
<dl class="function">
<dt id="larndsim.drifting.drift">
<code class="sig-prename descclassname">larndsim.drifting.</code><code class="sig-name descname">drift</code><span class="sig-paren">(</span><em class="sig-param">tracks</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.drifting.drift" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes as input an array of track segments and calculates
the properties of the segments at the anode:</p>
<blockquote>
<div><ul class="simple">
<li><p>z coordinate at the anode</p></li>
<li><p>number of electrons taking into account electron lifetime</p></li>
<li><p>longitudinal diffusion</p></li>
<li><p>transverse diffusion</p></li>
<li><p>time of arrival at the anode</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tracks</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array containing the tracks segment information</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-larndsim.detsim">
<span id="detector-simulation-stage"></span><h2>Detector simulation stage<a class="headerlink" href="#module-larndsim.detsim" title="Permalink to this headline">¶</a></h2>
<p>Module that calculates the current induced by edep-sim track segments
on the pixels</p>
<dl class="attribute">
<dt id="larndsim.detsim.current_model">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">current_model</code><a class="headerlink" href="#larndsim.detsim.current_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Parametrization of the induced current on the pixel, which depends
on the of arrival at the anode (<span class="math notranslate nohighlight">\(t_0\)</span>) and on the position
on the pixel pad.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – time where we evaluate the current</p></li>
<li><p><strong>t0</strong> (<em>float</em>) – time of arrival at the anode</p></li>
<li><p><strong>x</strong> (<em>float</em>) – distance between the point on the pixel and the pixel center
on the <span class="math notranslate nohighlight">\(x\)</span> axis</p></li>
<li><p><strong>y</strong> (<em>float</em>) – distance between the point on the pixel and the pixel center
on the <span class="math notranslate nohighlight">\(y\)</span> axis</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the induced current at time <span class="math notranslate nohighlight">\(t\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.detsim.get_closest_waveform">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">get_closest_waveform</code><a class="headerlink" href="#larndsim.detsim.get_closest_waveform" title="Permalink to this definition">¶</a></dt>
<dd><p>This function, given a point on the pixel pad and a time, returns the
closest tabulated waveformm from the response array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – x coordinate of the point</p></li>
<li><p><strong>y</strong> (<em>float</em>) – y coordinate of the point</p></li>
<li><p><strong>t</strong> (<em>float</em>) – time of the waveform</p></li>
<li><p><strong>response</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array containing the tabulated waveforms</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the value of the induced current at time <cite>t</cite> for a charge at <cite>(x,y)</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.detsim.get_pixel_coordinates">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">get_pixel_coordinates</code><a class="headerlink" href="#larndsim.detsim.get_pixel_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the coordinates of the pixel center given the pixel ID</p>
</dd></dl>

<dl class="function">
<dt id="larndsim.detsim.get_track_pixel_map">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">get_track_pixel_map</code><span class="sig-paren">(</span><em class="sig-param">track_pixel_map</em>, <em class="sig-param">unique_pix</em>, <em class="sig-param">pixels</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.detsim.get_track_pixel_map" title="Permalink to this definition">¶</a></dt>
<dd><p>This kernel fills a 2D array which contains, for each unique pixel,
an array with the track indeces associated to that pixel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>track_pixel_map</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2D array that will contain the
association between the unique pixels array and the track indeces</p></li>
<li><p><strong>unique_pix</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 1D array containing the unique pixels</p></li>
<li><p><strong>pixels</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2D array containing the pixels for each
track.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.detsim.rho">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">rho</code><a class="headerlink" href="#larndsim.detsim.rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that returns the amount of charge at a certain point in space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point</strong> (<em>tuple</em>) – point coordinates</p></li>
<li><p><strong>q</strong> (<em>float</em>) – total charge</p></li>
<li><p><strong>start</strong> (<em>tuple</em>) – segment start coordinates</p></li>
<li><p><strong>sigmas</strong> (<em>tuple</em>) – diffusion coefficients</p></li>
<li><p><strong>segment</strong> (<em>tuple</em>) – segment sizes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the amount of charge at <cite>point</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.detsim.sign">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">sign</code><a class="headerlink" href="#larndsim.detsim.sign" title="Permalink to this definition">¶</a></dt>
<dd><p>Sign function</p>
</dd></dl>

<dl class="function">
<dt id="larndsim.detsim.sum_pixel_signals">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">sum_pixel_signals</code><span class="sig-paren">(</span><em class="sig-param">pixels_signals</em>, <em class="sig-param">signals</em>, <em class="sig-param">track_starts</em>, <em class="sig-param">pixel_index_map</em>, <em class="sig-param">track_pixel_map</em>, <em class="sig-param">pixels_tracks_signals</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.detsim.sum_pixel_signals" title="Permalink to this definition">¶</a></dt>
<dd><p>This function sums the induced current signals on the same pixel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pixels_signals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2D array that will contain the
summed signal for each pixel. First dimension is the pixel ID, second
dimension is the time tick</p></li>
<li><p><strong>signals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 3D array with dimensions S x P x T,
where S is the number of track segments, P is the number of pixels, and T is
the number of time ticks.</p></li>
<li><p><strong>track_starts</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 1D array containing the starting time of
each track</p></li>
<li><p><strong>pixel_index_map</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2D array containing the correspondence between
the track index and the pixel ID index.</p></li>
<li><p><strong>track_pixel_map</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2D array containing the association between
the unique pixels array and the array containing the pixels for each track.</p></li>
<li><p><strong>pixels_tracks_signals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 3D array that will contain the waveforms
for each pixel and each track that induced current on the pixel.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.detsim.time_intervals">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">time_intervals</code><span class="sig-paren">(</span><em class="sig-param">track_starts</em>, <em class="sig-param">time_max</em>, <em class="sig-param">tracks</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.detsim.time_intervals" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the value of the longest signal time and stores the start
time of each segment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>track_starts</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array where
we store the segments start time</p></li>
<li><p><strong>time_max</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array where we store
the longest signal time</p></li>
<li><p><strong>event_id_map</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array containing
the event ID corresponding to each track</p></li>
<li><p><strong>tracks</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array containing the segment
information</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.detsim.track_point">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">track_point</code><a class="headerlink" href="#larndsim.detsim.track_point" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns the segment coordinates for a point along the <cite>z</cite> coordinate</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>tuple</em>) – start coordinates</p></li>
<li><p><strong>direction</strong> (<em>tuple</em>) – direction coordinates</p></li>
<li><p><strong>z</strong> (<em>float</em>) – <cite>z</cite> coordinate corresponding to the <cite>x</cite>, <cite>y</cite> coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the (x,y) pair of coordinates for the segment at <cite>z</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.detsim.tracks_current">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">tracks_current</code><span class="sig-paren">(</span><em class="sig-param">signals</em>, <em class="sig-param">pixels</em>, <em class="sig-param">tracks</em>, <em class="sig-param">response</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.detsim.tracks_current" title="Permalink to this definition">¶</a></dt>
<dd><p>This CUDA kernel calculates the charge induced on the pixels by the input tracks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – empty 3D array with dimensions S x P x T,
where S is the number of track segments, P is the number of pixels, and T is
the number of time ticks. The output is stored here.</p></li>
<li><p><strong>pixels</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2D array with dimensions S x P , where S is
the number of track segments, P is the number of pixels and contains the pixel ID number.</p></li>
<li><p><strong>tracks</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2D array containing the detector segments.</p></li>
<li><p><strong>response</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 3D array containing the tabulated response.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.detsim.truncexpon">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">truncexpon</code><a class="headerlink" href="#larndsim.detsim.truncexpon" title="Permalink to this definition">¶</a></dt>
<dd><p>A truncated exponential distribution.
To shift and/or scale the distribution use the <cite>loc</cite> and <cite>scale</cite> parameters.</p>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.detsim.z_interval">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">z_interval</code><a class="headerlink" href="#larndsim.detsim.z_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Here we calculate the interval in the drift direction for the pixel pID
using the impact factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_point</strong> (<em>tuple</em>) – coordinates of the segment start</p></li>
<li><p><strong>end_point</strong> (<em>tuple</em>) – coordinates of the segment end</p></li>
<li><p><strong>x_p</strong> (<em>float</em>) – pixel center <cite>x</cite> coordinate</p></li>
<li><p><strong>y_p</strong> (<em>float</em>) – pixel center <cite>y</cite> coordinate</p></li>
<li><p><strong>tolerance</strong> (<em>float</em>) – maximum distance between the pixel center and
the segment</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>z</cite> coordinate of the point of closest approach (POCA),
<cite>z</cite> coordinate of the first slice, <cite>z</cite> coordinate of the last slice.
(0,0,0) if POCA &gt; tolerance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-larndsim.pixels_from_track">
<span id="pixel-finder-utility"></span><h2>Pixel finder utility<a class="headerlink" href="#module-larndsim.pixels_from_track" title="Permalink to this headline">¶</a></h2>
<p>Module that finds which pixels lie on the projection on the anode plane
of each track segment. It can eventually include also the neighboring
pixels.</p>
<dl class="attribute">
<dt id="larndsim.pixels_from_track.get_active_pixels">
<code class="sig-prename descclassname">larndsim.pixels_from_track.</code><code class="sig-name descname">get_active_pixels</code><a class="headerlink" href="#larndsim.pixels_from_track.get_active_pixels" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts track segement to an array of active pixels
using an adapted version of the Bresenham algorithm
used to convert line to grid. Inspired by
<a class="reference external" href="https://stackoverflow.com/questions/8936183/bresenham-lines-w-o-diagonal-movement/28786538">https://stackoverflow.com/questions/8936183/bresenham-lines-w-o-diagonal-movement/28786538</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<em>int</em>) – start <cite>x</cite> coordinate</p></li>
<li><p><strong>y0</strong> (<em>int</em>) – start <cite>y</cite> coordinate</p></li>
<li><p><strong>x1</strong> (<em>int</em>) – end <cite>x</cite> coordinate</p></li>
<li><p><strong>y1</strong> (<em>int</em>) – end <cite>y</cite> coordinate</p></li>
<li><p><strong>plane_id</strong> (<em>int</em>) – plane index</p></li>
<li><p><strong>tot_pixels</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array where we store
the IDs of the pixels directly below the projection of
the segments</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.pixels_from_track.get_neighboring_pixels">
<code class="sig-prename descclassname">larndsim.pixels_from_track.</code><code class="sig-name descname">get_neighboring_pixels</code><span class="sig-paren">(</span><em class="sig-param">active_pixels</em>, <em class="sig-param">radius</em>, <em class="sig-param">neighboring_pixels</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.pixels_from_track.get_neighboring_pixels" title="Permalink to this definition">¶</a></dt>
<dd><p>For each active_pixel, it includes all
neighboring pixels within a specified radius</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>active_pixels</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array where we store
the IDs of the pixels directly below the projection of
the segments</p></li>
<li><p><strong>radius</strong> (<em>int</em>) – number of layers of neighboring pixels we
want to consider</p></li>
<li><p><strong>neighboring_pixels</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array where we store
the IDs of the pixels directly below the projection of
the segments and the ones next to them</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>number of total involved pixels</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.pixels_from_track.get_num_active_pixels">
<code class="sig-prename descclassname">larndsim.pixels_from_track.</code><code class="sig-name descname">get_num_active_pixels</code><a class="headerlink" href="#larndsim.pixels_from_track.get_num_active_pixels" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts number of pixels intercepted by the projection of the
track on the anode plane</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<em>int</em>) – start <cite>x</cite> coordinate</p></li>
<li><p><strong>y0</strong> (<em>int</em>) – start <cite>y</cite> coordinate</p></li>
<li><p><strong>x1</strong> (<em>int</em>) – end <cite>x</cite> coordinate</p></li>
<li><p><strong>y1</strong> (<em>int</em>) – end <cite>y</cite> coordinate</p></li>
<li><p><strong>plane_id</strong> (<em>int</em>) – plane index</p></li>
<li><p><strong>tot_pixels</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array where we store
the IDs of the pixels directly below the projection of
the segments</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.pixels_from_track.get_pixels">
<code class="sig-prename descclassname">larndsim.pixels_from_track.</code><code class="sig-name descname">get_pixels</code><span class="sig-paren">(</span><em class="sig-param">tracks</em>, <em class="sig-param">active_pixels</em>, <em class="sig-param">neighboring_pixels</em>, <em class="sig-param">n_pixels_list</em>, <em class="sig-param">radius</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.pixels_from_track.get_pixels" title="Permalink to this definition">¶</a></dt>
<dd><p>For all tracks, takes the xy start and end position
and calculates all impacted pixels by the track segment</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>track</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array where we store the
track segments information</p></li>
<li><p><strong>active_pixels</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array where we store
the IDs of the pixels directly below the projection of
the segments</p></li>
<li><p><strong>neighboring_pixels</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array where we store
the IDs of the pixels directly below the projection of
the segments and the ones next to them</p></li>
<li><p><strong>n_pixels_list</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – number of total involved
pixels</p></li>
<li><p><strong>radius</strong> (<em>int</em>) – number of pixels around the active pixels that
we are considering</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.pixels_from_track.id2pixel">
<code class="sig-prename descclassname">larndsim.pixels_from_track.</code><code class="sig-name descname">id2pixel</code><a class="headerlink" href="#larndsim.pixels_from_track.id2pixel" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the unique pixel identifer to an x,y,plane tuple</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>id</strong> (<em>int</em>) – unique pixel identifier</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>number of pixel pitches in x-dimension
pixel_y (int): number of pixel pitches in y-dimension
pixel_plane (int): pixel plane number</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pixel_x (int)</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.pixels_from_track.pixel2id">
<code class="sig-prename descclassname">larndsim.pixels_from_track.</code><code class="sig-name descname">pixel2id</code><a class="headerlink" href="#larndsim.pixels_from_track.pixel2id" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the x,y,plane tuple to a unique identifier</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pixel_x</strong> (<em>int</em>) – number of pixel pitches in x-dimension</p></li>
<li><p><strong>pixel_y</strong> (<em>int</em>) – number of pixel pitches in y-dimension</p></li>
<li><p><strong>pixel_plane</strong> (<em>int</em>) – pixel plane number</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>unique integer id</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="electronics-module">
<h2>Electronics module<a class="headerlink" href="#electronics-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-larndsim.consts">
<span id="constants"></span><h2>Constants<a class="headerlink" href="#module-larndsim.consts" title="Permalink to this headline">¶</a></h2>
<p>Module containing constants needed by the simulation</p>
<dl class="data">
<dt id="larndsim.consts.Ab">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">Ab</code><em class="property"> = 0.8</em><a class="headerlink" href="#larndsim.consts.Ab" title="Permalink to this definition">¶</a></dt>
<dd><p>Recombination <span class="math notranslate nohighlight">\(A_b\)</span> value for the Birks Model</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.alpha">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">alpha</code><em class="property"> = 0.93</em><a class="headerlink" href="#larndsim.consts.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Recombination <span class="math notranslate nohighlight">\(\alpha\)</span> constant for the Box model</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.beta">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">beta</code><em class="property"> = 0.207</em><a class="headerlink" href="#larndsim.consts.beta" title="Permalink to this definition">¶</a></dt>
<dd><p>Recombination <span class="math notranslate nohighlight">\(\beta\)</span> value for the Box model in <span class="math notranslate nohighlight">\((kV/cm)(g/cm^2)/MeV\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.eField">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">eField</code><em class="property"> = 0.5</em><a class="headerlink" href="#larndsim.consts.eField" title="Permalink to this definition">¶</a></dt>
<dd><p>Electric field magnitude in <span class="math notranslate nohighlight">\(kV/cm\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.e_charge">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">e_charge</code><em class="property"> = 1.602e-19</em><a class="headerlink" href="#larndsim.consts.e_charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Electron charge in Coulomb</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.kb">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">kb</code><em class="property"> = 0.0486</em><a class="headerlink" href="#larndsim.consts.kb" title="Permalink to this definition">¶</a></dt>
<dd><p>Recombination <span class="math notranslate nohighlight">\(k_b\)</span> value for the Birks Model in <span class="math notranslate nohighlight">\((kV/cm)(g/cm^2)/MeV\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.lArDensity">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">lArDensity</code><em class="property"> = 1.38</em><a class="headerlink" href="#larndsim.consts.lArDensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Liquid argon density in <span class="math notranslate nohighlight">\(g/cm^3\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.lifetime">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">lifetime</code><em class="property"> = 2200.0</em><a class="headerlink" href="#larndsim.consts.lifetime" title="Permalink to this definition">¶</a></dt>
<dd><p>Electron lifetime in <span class="math notranslate nohighlight">\(\mu s\)</span></p>
</dd></dl>

<dl class="function">
<dt id="larndsim.consts.load_detector_properties">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">load_detector_properties</code><span class="sig-paren">(</span><em class="sig-param">detprop_file</em>, <em class="sig-param">pixel_file</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.consts.load_detector_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>The function loads the detector properties and
the pixel geometry YAML files and stores the constants
as global variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>detprop_file</strong> (<em>str</em>) – detector properties YAML
filename</p></li>
<li><p><strong>pixel_file</strong> (<em>str</em>) – pixel layout YAML filename</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.long_diff">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">long_diff</code><em class="property"> = 4e-06</em><a class="headerlink" href="#larndsim.consts.long_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Longitudinal diffusion coefficient in <span class="math notranslate nohighlight">\(cm^2/\mu s\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.sampled_points">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">sampled_points</code><em class="property"> = 40</em><a class="headerlink" href="#larndsim.consts.sampled_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of sampled points for each segment slice</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.t_sampling">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">t_sampling</code><em class="property"> = 0.1</em><a class="headerlink" href="#larndsim.consts.t_sampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Time sampling in <span class="math notranslate nohighlight">\(\mu s\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.time_interval">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">time_interval</code><em class="property"> = (0, 200.0)</em><a class="headerlink" href="#larndsim.consts.time_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Drift time window in <span class="math notranslate nohighlight">\(\mu s\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.time_padding">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">time_padding</code><em class="property"> = 10</em><a class="headerlink" href="#larndsim.consts.time_padding" title="Permalink to this definition">¶</a></dt>
<dd><p>Signal time window padding in <span class="math notranslate nohighlight">\(\mu s\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.time_ticks">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">time_ticks</code><em class="property"> = array([0.000e+00, 1.000e-01, 2.000e-01, ..., 1.998e+02, 1.999e+02,        2.000e+02])</em><a class="headerlink" href="#larndsim.consts.time_ticks" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy array containing all the time ticks in the drift time window</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.time_window">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">time_window</code><em class="property"> = 8.9</em><a class="headerlink" href="#larndsim.consts.time_window" title="Permalink to this definition">¶</a></dt>
<dd><p>Current time window</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.tran_diff">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">tran_diff</code><em class="property"> = 8.8e-06</em><a class="headerlink" href="#larndsim.consts.tran_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Transverse diffusion coefficient in <span class="math notranslate nohighlight">\(cm^2/\mu s\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.vdrift">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">vdrift</code><em class="property"> = 0.1648</em><a class="headerlink" href="#larndsim.consts.vdrift" title="Permalink to this definition">¶</a></dt>
<dd><p>Drift velocity in <span class="math notranslate nohighlight">\(cm/\mu s\)</span></p>
</dd></dl>

</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, DUNE collaboration.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>