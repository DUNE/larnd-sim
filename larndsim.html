

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>larndsim package &mdash; larnd-sim 0.3.3 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Command-line utilities" href="cli.html" />
    <link rel="prev" title="Welcome to larnd-sim’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> larnd-sim
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">larndsim package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-larndsim.quenching">Quenching</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-larndsim.drifting">Drifting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-larndsim.detsim">Induced charge</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-larndsim.fee">Charge readout</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-larndsim.light_sim">Scintillation light</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-larndsim.consts">Constants</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command-line utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Output format</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">larnd-sim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>larndsim package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/larndsim.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="larndsim-package">
<h1>larndsim package<a class="headerlink" href="#larndsim-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-larndsim.quenching">
<span id="quenching"></span><h2>Quenching<a class="headerlink" href="#module-larndsim.quenching" title="Permalink to this headline">¶</a></h2>
<p>Module to implement the quenching of the ionized electrons
through the detector</p>
<dl class="function">
<dt id="larndsim.quenching.quench">
<code class="sig-prename descclassname">larndsim.quenching.</code><code class="sig-name descname">quench</code><span class="sig-paren">(</span><em class="sig-param">tracks</em>, <em class="sig-param">mode</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.quenching.quench" title="Permalink to this definition">¶</a></dt>
<dd><p>This CUDA kernel takes as input an array of track segments and calculates
the number of electrons and photons that reach the anode plane after recombination.
It is possible to pick among two models: Box (Baller, 2013 JINST 8 P08005) or
Birks (Amoruso, et al NIM A 523 (2004) 275).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tracks</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array containing the tracks segment information</p></li>
<li><p><strong>mode</strong> (<em>int</em>) – recombination model (physics.BOX or physics.BIRKS).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-larndsim.drifting">
<span id="drifting"></span><h2>Drifting<a class="headerlink" href="#module-larndsim.drifting" title="Permalink to this headline">¶</a></h2>
<p>Module to implement the propagation of the
electrons towards the anode.</p>
<dl class="function">
<dt id="larndsim.drifting.drift">
<code class="sig-prename descclassname">larndsim.drifting.</code><code class="sig-name descname">drift</code><span class="sig-paren">(</span><em class="sig-param">tracks</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.drifting.drift" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes as input an array of track segments and calculates
the properties of the segments at the anode:</p>
<blockquote>
<div><ul class="simple">
<li><p>z coordinate at the anode</p></li>
<li><p>number of electrons taking into account electron lifetime</p></li>
<li><p>longitudinal diffusion</p></li>
<li><p>transverse diffusion</p></li>
<li><p>time of arrival at the anode</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tracks</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array containing the tracks segment information</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-larndsim.detsim">
<span id="induced-charge"></span><h2>Induced charge<a class="headerlink" href="#module-larndsim.detsim" title="Permalink to this headline">¶</a></h2>
<p>Module that calculates the current induced by edep-sim track segments
on the pixels</p>
<dl class="attribute">
<dt id="larndsim.detsim.get_closest_waveform">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">get_closest_waveform</code><a class="headerlink" href="#larndsim.detsim.get_closest_waveform" title="Permalink to this definition">¶</a></dt>
<dd><p>This function, given a point on the pixel pad and a time, returns the
closest tabulated waveformm from the response array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – x coordinate of the point</p></li>
<li><p><strong>y</strong> (<em>float</em>) – y coordinate of the point</p></li>
<li><p><strong>t</strong> (<em>float</em>) – time of the waveform</p></li>
<li><p><strong>response</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array containing the tabulated waveforms</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the value of the induced current at time <cite>t</cite> for a charge at <cite>(x,y)</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.detsim.get_pixel_coordinates">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">get_pixel_coordinates</code><a class="headerlink" href="#larndsim.detsim.get_pixel_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the coordinates of the pixel center given the pixel ID</p>
</dd></dl>

<dl class="function">
<dt id="larndsim.detsim.get_track_pixel_map">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">get_track_pixel_map</code><span class="sig-paren">(</span><em class="sig-param">track_pixel_map</em>, <em class="sig-param">unique_pix</em>, <em class="sig-param">pixels</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.detsim.get_track_pixel_map" title="Permalink to this definition">¶</a></dt>
<dd><p>This kernel fills a 2D array which contains, for each unique pixel,
an array with the track indeces associated to that pixel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>track_pixel_map</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2D array that will contain the
association between the unique pixels array and the track indeces</p></li>
<li><p><strong>unique_pix</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 1D array containing the unique pixels</p></li>
<li><p><strong>pixels</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2D array containing the pixels for each
track.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.detsim.overlapping_segment">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">overlapping_segment</code><a class="headerlink" href="#larndsim.detsim.overlapping_segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the segment of the track defined by start, end that overlaps
with a circle centered at x,y</p>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.detsim.rho">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">rho</code><a class="headerlink" href="#larndsim.detsim.rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that returns the amount of charge at a certain point in space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point</strong> (<em>tuple</em>) – point coordinates</p></li>
<li><p><strong>q</strong> (<em>float</em>) – total charge</p></li>
<li><p><strong>start</strong> (<em>tuple</em>) – segment start coordinates</p></li>
<li><p><strong>sigmas</strong> (<em>tuple</em>) – diffusion coefficients</p></li>
<li><p><strong>segment</strong> (<em>tuple</em>) – segment sizes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the amount of charge at <cite>point</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.detsim.sign">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">sign</code><a class="headerlink" href="#larndsim.detsim.sign" title="Permalink to this definition">¶</a></dt>
<dd><p>Sign function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>float</em>) – input number</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1 if x&gt;=0 else -1</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.detsim.sum_pixel_signals">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">sum_pixel_signals</code><span class="sig-paren">(</span><em class="sig-param">pixels_signals</em>, <em class="sig-param">signals</em>, <em class="sig-param">track_starts</em>, <em class="sig-param">pixel_index_map</em>, <em class="sig-param">track_pixel_map</em>, <em class="sig-param">pixels_tracks_signals</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.detsim.sum_pixel_signals" title="Permalink to this definition">¶</a></dt>
<dd><p>This function sums the induced current signals on the same pixel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pixels_signals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2D array that will contain the
summed signal for each pixel. First dimension is the pixel ID, second
dimension is the time tick</p></li>
<li><p><strong>signals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 3D array with dimensions S x P x T,
where S is the number of track segments, P is the number of pixels, and T is
the number of time ticks.</p></li>
<li><p><strong>track_starts</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 1D array containing the starting time of
each track</p></li>
<li><p><strong>pixel_index_map</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2D array containing the correspondence between
the track index and the pixel ID index.</p></li>
<li><p><strong>track_pixel_map</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2D array containing the association between
the unique pixels array and the array containing the pixels for each track.</p></li>
<li><p><strong>pixels_tracks_signals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 3D array that will contain the waveforms
for each pixel and each track that induced current on the pixel.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.detsim.time_intervals">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">time_intervals</code><span class="sig-paren">(</span><em class="sig-param">track_starts</em>, <em class="sig-param">time_max</em>, <em class="sig-param">tracks</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.detsim.time_intervals" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the value of the longest signal time and stores the start
time of each segment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>track_starts</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array where
we store the segments start time</p></li>
<li><p><strong>time_max</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array where we store
the longest signal time</p></li>
<li><p><strong>tracks</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array containing the segment
information</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.detsim.track_point">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">track_point</code><a class="headerlink" href="#larndsim.detsim.track_point" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns the segment coordinates for a point along the <cite>z</cite> coordinate</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>tuple</em>) – start coordinates</p></li>
<li><p><strong>direction</strong> (<em>tuple</em>) – direction coordinates</p></li>
<li><p><strong>z</strong> (<em>float</em>) – <cite>z</cite> coordinate corresponding to the <cite>x</cite>, <cite>y</cite> coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the (x,y) pair of coordinates for the segment at <cite>z</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.detsim.tracks_current">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">tracks_current</code><span class="sig-paren">(</span><em class="sig-param">signals</em>, <em class="sig-param">pixels</em>, <em class="sig-param">tracks</em>, <em class="sig-param">response</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.detsim.tracks_current" title="Permalink to this definition">¶</a></dt>
<dd><p>This CUDA kernel calculates the charge induced on the pixels by the input tracks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – empty 3D array with dimensions S x P x T,
where S is the number of track segments, P is the number of pixels, and T is
the number of time ticks. The output is stored here.</p></li>
<li><p><strong>pixels</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2D array with dimensions S x P , where S is
the number of track segments, P is the number of pixels and contains the pixel ID number.</p></li>
<li><p><strong>tracks</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2D array containing the detector segments.</p></li>
<li><p><strong>response</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 3D array containing the tabulated response.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.detsim.tracks_current_mc">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">tracks_current_mc</code><span class="sig-paren">(</span><em class="sig-param">signals</em>, <em class="sig-param">pixels</em>, <em class="sig-param">tracks</em>, <em class="sig-param">response</em>, <em class="sig-param">rng_states</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.detsim.tracks_current_mc" title="Permalink to this definition">¶</a></dt>
<dd><p>This CUDA kernel calculates the charge induced on the pixels by the input tracks using a
MC method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – empty 3D array with dimensions S x P x T,
where S is the number of track segments, P is the number of pixels, and T is
the number of time ticks. The output is stored here.</p></li>
<li><p><strong>pixels</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2D array with dimensions S x P , where S is
the number of track segments, P is the number of pixels and contains the pixel ID number.</p></li>
<li><p><strong>tracks</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2D array containing the detector segments.</p></li>
<li><p><strong>response</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 3D array containing the tabulated response.</p></li>
<li><p><strong>rng_states</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array of random states for noise
generation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.detsim.z_interval">
<code class="sig-prename descclassname">larndsim.detsim.</code><code class="sig-name descname">z_interval</code><a class="headerlink" href="#larndsim.detsim.z_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Here we calculate the interval in the drift direction for the pixel pID
using the impact factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_point</strong> (<em>tuple</em>) – coordinates of the segment start</p></li>
<li><p><strong>end_point</strong> (<em>tuple</em>) – coordinates of the segment end</p></li>
<li><p><strong>x_p</strong> (<em>float</em>) – pixel center <cite>x</cite> coordinate</p></li>
<li><p><strong>y_p</strong> (<em>float</em>) – pixel center <cite>y</cite> coordinate</p></li>
<li><p><strong>tolerance</strong> (<em>float</em>) – maximum distance between the pixel center and
the segment</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>z</cite> coordinate of the point of closest approach (POCA),
<cite>z</cite> coordinate of the first slice, <cite>z</cite> coordinate of the last slice.
(0,0,0) if POCA &gt; tolerance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-larndsim.fee">
<span id="charge-readout"></span><h2>Charge readout<a class="headerlink" href="#module-larndsim.fee" title="Permalink to this headline">¶</a></h2>
<p>Module that simulates the front-end electronics (triggering, ADC)</p>
<dl class="data">
<dt id="larndsim.fee.ADC_BUSY_DELAY">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">ADC_BUSY_DELAY</code><em class="property"> = 9</em><a class="headerlink" href="#larndsim.fee.ADC_BUSY_DELAY" title="Permalink to this definition">¶</a></dt>
<dd><p>ADC busy delay in clock cycles</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.fee.ADC_COUNTS">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">ADC_COUNTS</code><em class="property"> = 256</em><a class="headerlink" href="#larndsim.fee.ADC_COUNTS" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of ADC counts</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.fee.ADC_HOLD_DELAY">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">ADC_HOLD_DELAY</code><em class="property"> = 15</em><a class="headerlink" href="#larndsim.fee.ADC_HOLD_DELAY" title="Permalink to this definition">¶</a></dt>
<dd><p>ADC hold delay in clock cycles</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.fee.BUFFER_RISETIME">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">BUFFER_RISETIME</code><em class="property"> = 0.1</em><a class="headerlink" href="#larndsim.fee.BUFFER_RISETIME" title="Permalink to this definition">¶</a></dt>
<dd><p>Buffer risetime in <span class="math notranslate nohighlight">\(\mu s\)</span> (set &gt;0 to include buffer response simulation)</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.fee.CLOCK_CYCLE">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">CLOCK_CYCLE</code><em class="property"> = 0.1</em><a class="headerlink" href="#larndsim.fee.CLOCK_CYCLE" title="Permalink to this definition">¶</a></dt>
<dd><p>Clock cycle time in <span class="math notranslate nohighlight">\(\mu s\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.fee.DISCRIMINATION_THRESHOLD">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">DISCRIMINATION_THRESHOLD</code><em class="property"> = 7000.0</em><a class="headerlink" href="#larndsim.fee.DISCRIMINATION_THRESHOLD" title="Permalink to this definition">¶</a></dt>
<dd><p>Discrimination threshold in e-</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.fee.DISCRIMINATOR_NOISE">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">DISCRIMINATOR_NOISE</code><em class="property"> = 650.0</em><a class="headerlink" href="#larndsim.fee.DISCRIMINATOR_NOISE" title="Permalink to this definition">¶</a></dt>
<dd><p>Discriminator noise in e-</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.fee.EVENT_RATE">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">EVENT_RATE</code><em class="property"> = 100000</em><a class="headerlink" href="#larndsim.fee.EVENT_RATE" title="Permalink to this definition">¶</a></dt>
<dd><p>Average time between events in microseconds</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.fee.GAIN">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">GAIN</code><em class="property"> = 4e-12</em><a class="headerlink" href="#larndsim.fee.GAIN" title="Permalink to this definition">¶</a></dt>
<dd><p>Front-end gain in <span class="math notranslate nohighlight">\(mV/e-\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.fee.MAX_ADC_VALUES">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">MAX_ADC_VALUES</code><em class="property"> = 10</em><a class="headerlink" href="#larndsim.fee.MAX_ADC_VALUES" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of ADC values stored per pixel</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.fee.RESET_CYCLES">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">RESET_CYCLES</code><em class="property"> = 1</em><a class="headerlink" href="#larndsim.fee.RESET_CYCLES" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset time in clock cycles</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.fee.RESET_NOISE_CHARGE">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">RESET_NOISE_CHARGE</code><em class="property"> = 900.0</em><a class="headerlink" href="#larndsim.fee.RESET_NOISE_CHARGE" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset noise in e-</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.fee.ROLLOVER_CYCLES">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">ROLLOVER_CYCLES</code><em class="property"> = 2147483648</em><a class="headerlink" href="#larndsim.fee.ROLLOVER_CYCLES" title="Permalink to this definition">¶</a></dt>
<dd><p>Clock rollover / reset time in larpix clock ticks</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.fee.UNCORRELATED_NOISE_CHARGE">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">UNCORRELATED_NOISE_CHARGE</code><em class="property"> = 500.0</em><a class="headerlink" href="#larndsim.fee.UNCORRELATED_NOISE_CHARGE" title="Permalink to this definition">¶</a></dt>
<dd><p>Uncorrelated noise in e-</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.fee.V_CM">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">V_CM</code><em class="property"> = 2.8800000000000004e-07</em><a class="headerlink" href="#larndsim.fee.V_CM" title="Permalink to this definition">¶</a></dt>
<dd><p>Common-mode voltage in <span class="math notranslate nohighlight">\(mV\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.fee.V_PEDESTAL">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">V_PEDESTAL</code><em class="property"> = 5.800000000000001e-07</em><a class="headerlink" href="#larndsim.fee.V_PEDESTAL" title="Permalink to this definition">¶</a></dt>
<dd><p>Pedestal voltage in <span class="math notranslate nohighlight">\(mV\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.fee.V_REF">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">V_REF</code><em class="property"> = 1.3e-06</em><a class="headerlink" href="#larndsim.fee.V_REF" title="Permalink to this definition">¶</a></dt>
<dd><p>Reference voltage in <span class="math notranslate nohighlight">\(mV\)</span></p>
</dd></dl>

<dl class="function">
<dt id="larndsim.fee.digitize">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">digitize</code><span class="sig-paren">(</span><em class="sig-param">integral_list</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.fee.digitize" title="Permalink to this definition">¶</a></dt>
<dd><p>The function takes as input the integrated charge and returns the digitized
ADC counts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>integral_list</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – list of charge collected by each pixel</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of ADC values for each pixel</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.fee.export_to_hdf5">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">export_to_hdf5</code><span class="sig-paren">(</span><em class="sig-param">event_id_list</em>, <em class="sig-param">adc_list</em>, <em class="sig-param">adc_ticks_list</em>, <em class="sig-param">unique_pix</em>, <em class="sig-param">current_fractions</em>, <em class="sig-param">track_ids</em>, <em class="sig-param">filename</em>, <em class="sig-param">event_start_times</em>, <em class="sig-param">is_first_event</em>, <em class="sig-param">light_trigger_times=None</em>, <em class="sig-param">light_trigger_event_id=None</em>, <em class="sig-param">light_trigger_modules=None</em>, <em class="sig-param">bad_channels=None</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.fee.export_to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the ADC counts in the LArPix HDF5 format.
:Parameters: * <strong>event_id_list</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – list of event ids for each ADC value for each pixel</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>adc_list</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – list of ADC values for each pixel</p></li>
<li><p><strong>adc_ticks_list</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – list of time ticks for each pixel</p></li>
<li><p><strong>unique_pix</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – list of pixel IDs</p></li>
<li><p><strong>current_fractions</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array containing the fractional current
induced by each track on each pixel</p></li>
<li><p><strong>track_ids</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2D array containing the track IDs associated
to each pixel</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – filename of HDF5 output file</p></li>
<li><p><strong>event_times</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – list of timestamps for start each unique event [in microseconds]</p></li>
<li><p><strong>is_first_event</strong> (<em>bool</em>) – <cite>True</cite> if this is the first event to save to the file</p></li>
<li><p><strong>light_trigger_times</strong> (<em>array</em>) – 1D array of light trigger timestamps (relative to event t0) [in microseconds]</p></li>
<li><p><strong>light_trigger_event_id</strong> (<em>array</em>) – 1D array of event id for each light trigger</p></li>
<li><p><strong>light_trigger_modules</strong> (<em>array</em>) – 1D array of module id for each light trigger</p></li>
<li><p><strong>bad_channels</strong> (<em>dict</em>) – dictionary containing as value a list of bad channels and as
the chip key</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a tuple containing the list of LArPix packets and the list of entries for the <cite>mc_packets_assn</cite> dataset</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.fee.gen_event_times">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">gen_event_times</code><span class="sig-paren">(</span><em class="sig-param">nevents</em>, <em class="sig-param">t0</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.fee.gen_event_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate sequential event times assuming events are uncorrelated</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nevents</strong> (<em>int</em>) – number of event times to generate</p></li>
<li><p><strong>t0</strong> (<em>int</em>) – offset to apply [microseconds]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>shape <cite>(nevents,)</cite>, sequential event times [microseconds]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.fee.get_adc_values">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">get_adc_values</code><span class="sig-paren">(</span><em class="sig-param">pixels_signals</em>, <em class="sig-param">pixels_signals_tracks</em>, <em class="sig-param">time_ticks</em>, <em class="sig-param">adc_list</em>, <em class="sig-param">adc_ticks_list</em>, <em class="sig-param">time_padding</em>, <em class="sig-param">rng_states</em>, <em class="sig-param">current_fractions</em>, <em class="sig-param">pixel_thresholds</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.fee.get_adc_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of self-trigger logic</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pixels_signals</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – list of induced currents for
each pixel</p></li>
<li><p><strong>pixels_signals_tracks</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – list of induced currents
for each track that induces current on each pixel</p></li>
<li><p><strong>time_ticks</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – list of time ticks for each pixel</p></li>
<li><p><strong>adc_list</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – list of integrated charges for each
pixel</p></li>
<li><p><strong>adc_ticks_list</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – list of the time ticks that
correspond to each integrated charge</p></li>
<li><p><strong>time_padding</strong> (<em>float</em>) – time interval to add to each time tick.</p></li>
<li><p><strong>rng_states</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – array of random states for noise
generation</p></li>
<li><p><strong>current_fractions</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – 2D array that will contain
the fraction of current induced on the pixel by each track</p></li>
<li><p><strong>pixel_thresholds(</strong> – obj: <cite>numpy.ndarray</cite>): list of discriminator
thresholds for each pixel</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.fee.rotate_tile">
<code class="sig-prename descclassname">larndsim.fee.</code><code class="sig-name descname">rotate_tile</code><span class="sig-paren">(</span><em class="sig-param">pixel_id</em>, <em class="sig-param">tile_id</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.fee.rotate_tile" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the pixel ID of the rotated tile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pixel_id</strong> (<em>int</em>) – pixel ID</p></li>
<li><p><strong>tile_id</strong> (<em>int</em>) – tile ID</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pixel indeces</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-larndsim.light_sim">
<span id="scintillation-light"></span><h2>Scintillation light<a class="headerlink" href="#module-larndsim.light_sim" title="Permalink to this headline">¶</a></h2>
<p>Module that simulates smearing effects of the light incident on each
photodetector</p>
<dl class="function">
<dt id="larndsim.light_sim.calc_light_detector_response">
<code class="sig-prename descclassname">larndsim.light_sim.</code><code class="sig-name descname">calc_light_detector_response</code><span class="sig-paren">(</span><em class="sig-param">light_sample_inc</em>, <em class="sig-param">light_sample_inc_true_track_id</em>, <em class="sig-param">light_sample_inc_true_photons</em>, <em class="sig-param">light_response</em>, <em class="sig-param">light_response_true_track_id</em>, <em class="sig-param">light_response_true_photons</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.light_sim.calc_light_detector_response" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulates the SiPM reponse and digit</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>light_sample_inc</strong> (<em>array</em>) – shape <cite>(ndet, ntick)</cite>, PE produced on each SiPM at each time tick</p></li>
<li><p><strong>light_response</strong> (<em>array</em>) – shape <cite>(ndet, ntick)</cite>, ADC value at each time tick</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.light_sim.calc_scintillation_effect">
<code class="sig-prename descclassname">larndsim.light_sim.</code><code class="sig-name descname">calc_scintillation_effect</code><span class="sig-paren">(</span><em class="sig-param">light_sample_inc</em>, <em class="sig-param">light_sample_inc_true_track_id</em>, <em class="sig-param">light_sample_inc_true_photons</em>, <em class="sig-param">light_sample_inc_scint</em>, <em class="sig-param">light_sample_inc_scint_true_track_id</em>, <em class="sig-param">light_sample_inc_scint_true_photons</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.light_sim.calc_scintillation_effect" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a smearing effect due to the liquid argon scintillation time profile using
a two decay component scintillation model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>light_sample_inc</strong> (<em>array</em>) – shape <cite>(ndet, ntick)</cite>, light incident on each detector</p></li>
<li><p><strong>light_sample_inc_scint</strong> (<em>array</em>) – output array, shape <cite>(ndet, ntick)</cite>, light incident on each detector after accounting for scintillation time</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.light_sim.calc_stat_fluctuations">
<code class="sig-prename descclassname">larndsim.light_sim.</code><code class="sig-name descname">calc_stat_fluctuations</code><span class="sig-paren">(</span><em class="sig-param">light_sample_inc</em>, <em class="sig-param">light_sample_inc_disc</em>, <em class="sig-param">rng_states</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.light_sim.calc_stat_fluctuations" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulates Poisson fluctuations in the number of PE per time tick.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>light_sample_inc</strong> (<em>array</em>) – shape <cite>(ndet, ntick)</cite>, light incident on each detector</p></li>
<li><p><strong>light_sample_inc_disc</strong> (<em>array</em>) – output array, shape <cite>(ndet, ntick)</cite>, number PE in each time interval</p></li>
<li><p><strong>rng_states</strong> (<em>array</em>) – shape <cite>(&gt;ndet*ntick,)</cite>, random number states</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.light_sim.digitize_signal">
<code class="sig-prename descclassname">larndsim.light_sim.</code><code class="sig-name descname">digitize_signal</code><span class="sig-paren">(</span><em class="sig-param">signal</em>, <em class="sig-param">signal_op_channel_idx</em>, <em class="sig-param">trigger_idx</em>, <em class="sig-param">trigger_op_channel_idx</em>, <em class="sig-param">signal_true_track_id</em>, <em class="sig-param">signal_true_photons</em>, <em class="sig-param">digit_signal</em>, <em class="sig-param">digit_signal_true_track_id</em>, <em class="sig-param">digit_signal_true_photons</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.light_sim.digitize_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate signal to the appropriate sampling frequency</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>array</em>) – shape <cite>(ndet, nticks)</cite>, simulated signal on each channel</p></li>
<li><p><strong>signal_op_channel_idx</strong> (<em>array</em>) – shape <cite>(ndet,)</cite>, optical channel index for each simulated signal</p></li>
<li><p><strong>trigger_idx</strong> (<em>array</em>) – shape <cite>(ntrigs,)</cite>, tick index for each trigger</p></li>
<li><p><strong>trigger_op_channel_idx</strong> (<em>array</em>) – shape <cite>(ntrigs, ndet_module)</cite>, optical channel index for each trigger</p></li>
<li><p><strong>digit_signal</strong> (<em>array</em>) – output array, shape <cite>(ntrigs, ndet_module, nsamples)</cite>, digitized signal</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.light_sim.export_to_hdf5">
<code class="sig-prename descclassname">larndsim.light_sim.</code><code class="sig-name descname">export_to_hdf5</code><span class="sig-paren">(</span><em class="sig-param">event_id</em>, <em class="sig-param">start_times</em>, <em class="sig-param">trigger_idx</em>, <em class="sig-param">op_channel_idx</em>, <em class="sig-param">waveforms</em>, <em class="sig-param">output_filename</em>, <em class="sig-param">event_times</em>, <em class="sig-param">waveforms_true_track_id</em>, <em class="sig-param">waveforms_true_photons</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.light_sim.export_to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves waveforms to output file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event_id</strong> (<em>array</em>) – shape <cite>(ntrigs,)</cite>, event id for each trigger</p></li>
<li><p><strong>start_times</strong> (<em>array</em>) – shape <cite>(ntrigs,)</cite>, simulation time offset for each trigger [microseconds]</p></li>
<li><p><strong>trigger_idx</strong> (<em>array</em>) – shape <cite>(ntrigs,)</cite>, simulation time tick of each trigger</p></li>
<li><p><strong>op_channel_idx</strong> (<em>array</em>) – shape <cite>(ntrigs, ndet_module)</cite>, optical channel index for each trigger</p></li>
<li><p><strong>waveforms</strong> (<em>array</em>) – shape <cite>(ntrigs, ndet_module, nsamples)</cite>, simulated waveforms to save</p></li>
<li><p><strong>output_filename</strong> (<em>str</em>) – output hdf5 file path</p></li>
<li><p><strong>event_times</strong> (<em>array</em>) – shape <cite>(nevents,)</cite>, global event t0 for each unique event [microseconds]</p></li>
<li><p><strong>waveforms_true_track_id</strong> (<em>array</em>) – shape <cite>(ntrigs, ndet, nsamples, ntruth)</cite>, segment ids contributing to each sample</p></li>
<li><p><strong>waveforms_true_photons</strong> (<em>array</em>) – shape <cite>(ntrigs, ndet, nsamples, ntruth)</cite>, true photocurrent at each sample</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.light_sim.gen_light_detector_noise">
<code class="sig-prename descclassname">larndsim.light_sim.</code><code class="sig-name descname">gen_light_detector_noise</code><span class="sig-paren">(</span><em class="sig-param">shape</em>, <em class="sig-param">light_det_noise</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.light_sim.gen_light_detector_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates uncorrelated noise with a defined frequency spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>) – desired shape of output noise, <cite>shape[0]</cite> must equal <cite>light_det_noise.shape[0]</cite></p></li>
<li><p><strong>light_det_noise</strong> (<em>array</em>) – FFT of noise, <cite>light_det_noise.ndim == 2</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>shape <cite>(shape[0], shape[1])</cite>, randomly generated sample noise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.light_sim.get_active_op_channel">
<code class="sig-prename descclassname">larndsim.light_sim.</code><code class="sig-name descname">get_active_op_channel</code><span class="sig-paren">(</span><em class="sig-param">light_incidence</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.light_sim.get_active_op_channel" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array of optical channels that need to be simulated</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>light_incidence</strong> (<em>array</em>) – shape <cite>(ntracks, ndet)</cite>, containing first hit time and number of photons on each detector</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>shape <cite>(ndet_active,)</cite> op detector index of each active channel (<cite>int</cite>)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.light_sim.get_nticks">
<code class="sig-prename descclassname">larndsim.light_sim.</code><code class="sig-name descname">get_nticks</code><span class="sig-paren">(</span><em class="sig-param">light_incidence</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.light_sim.get_nticks" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the number of time ticks needed to simulate light signals of the
event (plus the desired pre- and post-intervals)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>light_incidence</strong> (<em>array</em>) – shape <cite>(ntracks, ndet)</cite>, containing first hit time and number of photons on each detector</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>number of time ticks (<cite>int</cite>), time of first tick (<cite>float</cite>) [in microseconds]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.light_sim.get_triggers">
<code class="sig-prename descclassname">larndsim.light_sim.</code><code class="sig-name descname">get_triggers</code><span class="sig-paren">(</span><em class="sig-param">signal</em>, <em class="sig-param">group_threshold</em>, <em class="sig-param">op_channel_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.light_sim.get_triggers" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifies each simulated ticks that would initiate a trigger taking into account the ADC digitization window</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>array</em>) – shape <cite>(ndet, nticks)</cite>, simulated signal on each channel</p></li>
<li><p><strong>group_threshold</strong> (<em>array</em>) – shape <cite>(ngrp,)</cite>, threshold on group sum (requires <cite>ndet/ngrp == OP_CHANNEL_PER_TRIG</cite>)</p></li>
<li><p><strong>op_channel_idx</strong> (<em>array</em>) – shape <cite>(ndet,)</cite>, optical channel index for each signal</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array of tick indices at each trigger (shape <cite>(ntrigs,)</cite>) and array of op channel index (shape <cite>(ntrigs, ndet_module)</cite>)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.light_sim.interp">
<code class="sig-prename descclassname">larndsim.light_sim.</code><code class="sig-name descname">interp</code><a class="headerlink" href="#larndsim.light_sim.interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a simple linear interpolation of an array at a given floating point
index</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>float</em>) – index into array to interpolate</p></li>
<li><p><strong>arr</strong> (<em>array</em>) – 1D array of values to interpolate</p></li>
<li><p><strong>low</strong> (<em>float</em>) – value to return if index is less than 0</p></li>
<li><p><strong>high</strong> (<em>float</em>) – value to return if index is above <cite>len(arr)-1</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>interpolated array value</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.light_sim.scintillation_model">
<code class="sig-prename descclassname">larndsim.light_sim.</code><code class="sig-name descname">scintillation_model</code><a class="headerlink" href="#larndsim.light_sim.scintillation_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the fraction of scintillation photons emitted
during time interval <cite>time_tick</cite> to <cite>time_tick + 1</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_tick</strong> (<em>int</em>) – time tick relative to t0</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>fraction of scintillation photons</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.light_sim.sim_triggers">
<code class="sig-prename descclassname">larndsim.light_sim.</code><code class="sig-name descname">sim_triggers</code><span class="sig-paren">(</span><em class="sig-param">bpg</em>, <em class="sig-param">tpb</em>, <em class="sig-param">signal</em>, <em class="sig-param">signal_op_channel_idx</em>, <em class="sig-param">signal_true_track_id</em>, <em class="sig-param">signal_true_photons</em>, <em class="sig-param">trigger_idx</em>, <em class="sig-param">op_channel_idx</em>, <em class="sig-param">digit_samples</em>, <em class="sig-param">light_det_noise</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.light_sim.sim_triggers" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates digitized waveforms at specified simulation tick indices</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bpg</strong> (<em>tuple</em>) – blocks per grid used to generate digitized waveforms, <cite>len(bpg) == 3</cite>, <cite>prod(bpg) * prod(tpb) &gt;= digit_samples.size</cite></p></li>
<li><p><strong>tpb</strong> (<em>tuple</em>) – threads per grid used to generate digitized waveforms, <cite>len(bpg) == 3</cite>, <cite>bpg[i] * tpb[i] &gt;= digit_samples.shape[i]</cite></p></li>
<li><p><strong>signal</strong> (<em>array</em>) – shape <cite>(ndet, nticks)</cite>, simulated signal on each channel</p></li>
<li><p><strong>signal_op_channel_idx</strong> (<em>array</em>) – shape <cite>(ndet,)</cite>, optical channel index for each simulated signal</p></li>
<li><p><strong>signal_true_track_id</strong> (<em>array</em>) – shape <cite>(ndet, nticks, ntruth)</cite>, true segments associated with each tick</p></li>
<li><p><strong>signal_true_photons</strong> (<em>array</em>) – shape <cite>(ndet, nticks, ntruth)</cite>, true photons associated with each tick from each track</p></li>
<li><p><strong>trigger_idx</strong> (<em>array</em>) – shape <cite>(ntrigs,)</cite>, tick index for each trigger to digitize</p></li>
<li><p><strong>op_channel_idx</strong> (<em>array</em>) – shape <cite>(ntrigs, ndet_module)</cite>, optical channel indices for each trigger</p></li>
<li><p><strong>digit_samples</strong> (<em>int</em>) – number of digitizations per waveform</p></li>
<li><p><strong>light_det_noise</strong> (<em>array</em>) – shape <cite>(ndet, nnoise_bins)</cite>, noise spectrum for each channel (only used if waveforms extend past simulated signal)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>shape <cite>(ntrigs, ndet_module, digit_samples)</cite>, digitized waveform on each channel for each trigger</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.light_sim.sipm_response_model">
<code class="sig-prename descclassname">larndsim.light_sim.</code><code class="sig-name descname">sipm_response_model</code><a class="headerlink" href="#larndsim.light_sim.sipm_response_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the SiPM response from a PE at <cite>time_tick</cite> relative to the PE time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idet</strong> (<em>int</em>) – SiPM index</p></li>
<li><p><strong>time_tick</strong> (<em>int</em>) – time tick relative to t0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>response</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.light_sim.sum_light_signals">
<code class="sig-prename descclassname">larndsim.light_sim.</code><code class="sig-name descname">sum_light_signals</code><span class="sig-paren">(</span><em class="sig-param">segments</em>, <em class="sig-param">segment_voxel</em>, <em class="sig-param">segment_track_id</em>, <em class="sig-param">light_inc</em>, <em class="sig-param">lut</em>, <em class="sig-param">start_time</em>, <em class="sig-param">light_sample_inc</em>, <em class="sig-param">light_sample_inc_true_track_id</em>, <em class="sig-param">light_sample_inc_true_photons</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.light_sim.sum_light_signals" title="Permalink to this definition">¶</a></dt>
<dd><p>Sums the number of photons observed by each light detector at each time tick</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>segments</strong> (<em>array</em>) – shape <cite>(ntracks,)</cite>, edep-sim tracks to simulate</p></li>
<li><p><strong>segment_voxel</strong> (<em>array</em>) – shape <cite>(ntracks, 3)</cite>, LUT voxel for eack edep-sim track</p></li>
<li><p><strong>segment_track_id</strong> (<em>array</em>) – shape <cite>(ntracks,)</cite>, unique id for each track segment (for MC truth backtracking)</p></li>
<li><p><strong>light_inc</strong> (<em>array</em>) – shape <cite>(ntracks, ndet)</cite>, number of photons incident on each detector and voxel id</p></li>
<li><p><strong>lut</strong> (<em>array</em>) – shape <cite>(nx,ny,nz)</cite>, light look up table</p></li>
<li><p><strong>start_time</strong> (<em>float</em>) – start time of light simulation in microseconds</p></li>
<li><p><strong>light_sample_inc</strong> (<em>array</em>) – output array, shape <cite>(ndet, nticks)</cite>, number of photons incident on each detector at each time tick (propogation delay only)</p></li>
<li><p><strong>light_sample_inc_true_track_id</strong> (<em>array</em>) – output array, shape <cite>(ndet, nticks, maxtracks)</cite>, true track ids on each detector at each time tick (propogation delay only)</p></li>
<li><p><strong>light_sample_inc_true_photons</strong> (<em>array</em>) – output array, shape <cite>(ndet, nticks, maxtracks)</cite>, number of photons incident on each detector at each time tick from each track</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="larndsim.light_sim.xoroshiro128p_poisson_int32">
<code class="sig-prename descclassname">larndsim.light_sim.</code><code class="sig-name descname">xoroshiro128p_poisson_int32</code><a class="headerlink" href="#larndsim.light_sim.xoroshiro128p_poisson_int32" title="Permalink to this definition">¶</a></dt>
<dd><p>Return poisson distributed int32 and advance <cite>states[index]</cite>. For efficiency,
if <cite>mean &gt; 30</cite>, returns a gaussian distributed int32 with <cite>mean == mean</cite>
and <cite>std = sqrt(mean)</cite> truncated at 0 (approximately equivalent to a poisson-
distributed number)</p>
<p>[DOI:10.1007/978-1-4613-8643-8_10]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> (<em>float</em>) – mean of poisson distribution</p></li>
<li><p><strong>states</strong> (<em>array</em>) – array of RNG states</p></li>
<li><p><strong>index</strong> (<em>int</em>) – offset in states to update</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-larndsim.consts">
<span id="constants"></span><h2>Constants<a class="headerlink" href="#module-larndsim.consts" title="Permalink to this headline">¶</a></h2>
<p>Set global variables with detector and physics properties</p>
<dl class="function">
<dt id="larndsim.consts.load_properties">
<code class="sig-prename descclassname">larndsim.consts.</code><code class="sig-name descname">load_properties</code><span class="sig-paren">(</span><em class="sig-param">detprop_file</em>, <em class="sig-param">pixel_file</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.consts.load_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>The function loads the detector properties and
the pixel geometry YAML files and stores the constants
as global variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>detprop_file</strong> (<em>str</em>) – detector properties YAML filename</p></li>
<li><p><strong>pixel_file</strong> (<em>str</em>) – pixel layout YAML filename</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-larndsim.consts.detector"></span><p>Set detector constants</p>
<dl class="data">
<dt id="larndsim.consts.detector.DEFAULT_PLANE_INDEX">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">DEFAULT_PLANE_INDEX</code><em class="property"> = 48879</em><a class="headerlink" href="#larndsim.consts.detector.DEFAULT_PLANE_INDEX" title="Permalink to this definition">¶</a></dt>
<dd><p>Default value for pixel_plane, to indicate out-of-bounds edep</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.DRIFT_LENGTH">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">DRIFT_LENGTH</code><em class="property"> = 0</em><a class="headerlink" href="#larndsim.consts.detector.DRIFT_LENGTH" title="Permalink to this definition">¶</a></dt>
<dd><p>TPC drift length in <span class="math notranslate nohighlight">\(cm\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.ELECTRON_LIFETIME">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">ELECTRON_LIFETIME</code><em class="property"> = 2200.0</em><a class="headerlink" href="#larndsim.consts.detector.ELECTRON_LIFETIME" title="Permalink to this definition">¶</a></dt>
<dd><p>Electron lifetime in <span class="math notranslate nohighlight">\(\mu s\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.E_FIELD">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">E_FIELD</code><em class="property"> = 0.5</em><a class="headerlink" href="#larndsim.consts.detector.E_FIELD" title="Permalink to this definition">¶</a></dt>
<dd><p>Electric field magnitude in <span class="math notranslate nohighlight">\(kV/cm\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.LAR_DENSITY">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">LAR_DENSITY</code><em class="property"> = 1.38</em><a class="headerlink" href="#larndsim.consts.detector.LAR_DENSITY" title="Permalink to this definition">¶</a></dt>
<dd><p>Liquid argon density in <span class="math notranslate nohighlight">\(g/cm^3\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.LONG_DIFF">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">LONG_DIFF</code><em class="property"> = 4e-06</em><a class="headerlink" href="#larndsim.consts.detector.LONG_DIFF" title="Permalink to this definition">¶</a></dt>
<dd><p>Longitudinal diffusion coefficient in <span class="math notranslate nohighlight">\(cm^2/\mu s\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.MODULE_TO_IO_GROUPS">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">MODULE_TO_IO_GROUPS</code><em class="property"> = {}</em><a class="headerlink" href="#larndsim.consts.detector.MODULE_TO_IO_GROUPS" title="Permalink to this definition">¶</a></dt>
<dd><p>Association between modules and io groups</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.MODULE_TO_TPCS">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">MODULE_TO_TPCS</code><em class="property"> = {}</em><a class="headerlink" href="#larndsim.consts.detector.MODULE_TO_TPCS" title="Permalink to this definition">¶</a></dt>
<dd><p>Association between modules and tpcs</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.N_PIXELS">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">N_PIXELS</code><em class="property"> = (0, 0)</em><a class="headerlink" href="#larndsim.consts.detector.N_PIXELS" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of pixels</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.N_PIXELS_PER_TILE">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">N_PIXELS_PER_TILE</code><em class="property"> = (0, 0)</em><a class="headerlink" href="#larndsim.consts.detector.N_PIXELS_PER_TILE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of pixels in each tile</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.PIXEL_CONNECTION_DICT">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">PIXEL_CONNECTION_DICT</code><em class="property"> = {}</em><a class="headerlink" href="#larndsim.consts.detector.PIXEL_CONNECTION_DICT" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary between pixel ID and its position in the pixel array</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.PIXEL_PITCH">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">PIXEL_PITCH</code><em class="property"> = 0.4434</em><a class="headerlink" href="#larndsim.consts.detector.PIXEL_PITCH" title="Permalink to this definition">¶</a></dt>
<dd><p>Pixel pitch in <span class="math notranslate nohighlight">\(cm\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.RESPONSE_BIN_SIZE">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">RESPONSE_BIN_SIZE</code><em class="property"> = 0.04434</em><a class="headerlink" href="#larndsim.consts.detector.RESPONSE_BIN_SIZE" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatial sampling in the pixel reponse file in <span class="math notranslate nohighlight">\(cm\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.RESPONSE_SAMPLING">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">RESPONSE_SAMPLING</code><em class="property"> = 0.1</em><a class="headerlink" href="#larndsim.consts.detector.RESPONSE_SAMPLING" title="Permalink to this definition">¶</a></dt>
<dd><p>Time sampling in the pixel response file in <span class="math notranslate nohighlight">\(\mu s\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.SAMPLED_POINTS">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">SAMPLED_POINTS</code><em class="property"> = 40</em><a class="headerlink" href="#larndsim.consts.detector.SAMPLED_POINTS" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of sampled points for each segment slice</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.TEMPERATURE">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">TEMPERATURE</code><em class="property"> = 87.17</em><a class="headerlink" href="#larndsim.consts.detector.TEMPERATURE" title="Permalink to this definition">¶</a></dt>
<dd><p>Detector temperature in K</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.TILE_BORDERS">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">TILE_BORDERS</code><em class="property"> = array([[0., 0.],        [0., 0.]])</em><a class="headerlink" href="#larndsim.consts.detector.TILE_BORDERS" title="Permalink to this definition">¶</a></dt>
<dd><p>Pixel tile borders in <span class="math notranslate nohighlight">\(cm\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.TILE_CHIP_TO_IO">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">TILE_CHIP_TO_IO</code><em class="property"> = {}</em><a class="headerlink" href="#larndsim.consts.detector.TILE_CHIP_TO_IO" title="Permalink to this definition">¶</a></dt>
<dd><p>Association between chips and io channels</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.TILE_MAP">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">TILE_MAP</code><em class="property"> = ()</em><a class="headerlink" href="#larndsim.consts.detector.TILE_MAP" title="Permalink to this definition">¶</a></dt>
<dd><p>Map of tiles in each anode</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.TILE_ORIENTATIONS">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">TILE_ORIENTATIONS</code><em class="property"> = {}</em><a class="headerlink" href="#larndsim.consts.detector.TILE_ORIENTATIONS" title="Permalink to this definition">¶</a></dt>
<dd><p>Tile orientations in each anode</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.TILE_POSITIONS">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">TILE_POSITIONS</code><em class="property"> = {}</em><a class="headerlink" href="#larndsim.consts.detector.TILE_POSITIONS" title="Permalink to this definition">¶</a></dt>
<dd><p>Tile position wrt the center of the anode in <span class="math notranslate nohighlight">\(cm\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.TIME_INTERVAL">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">TIME_INTERVAL</code><em class="property"> = (0, 200.0)</em><a class="headerlink" href="#larndsim.consts.detector.TIME_INTERVAL" title="Permalink to this definition">¶</a></dt>
<dd><p>Drift time window in <span class="math notranslate nohighlight">\(\mu s\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.TIME_PADDING">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">TIME_PADDING</code><em class="property"> = 10</em><a class="headerlink" href="#larndsim.consts.detector.TIME_PADDING" title="Permalink to this definition">¶</a></dt>
<dd><p>Signal time window padding in <span class="math notranslate nohighlight">\(\mu s\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.TIME_SAMPLING">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">TIME_SAMPLING</code><em class="property"> = 0.1</em><a class="headerlink" href="#larndsim.consts.detector.TIME_SAMPLING" title="Permalink to this definition">¶</a></dt>
<dd><p>Time sampling in <span class="math notranslate nohighlight">\(\mu s\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.TIME_TICKS">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">TIME_TICKS</code><em class="property"> = array([0.000e+00, 1.000e-01, 2.000e-01, ..., 1.998e+02, 1.999e+02,        2.000e+02])</em><a class="headerlink" href="#larndsim.consts.detector.TIME_TICKS" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy array containing all the time ticks in the drift time window</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.TIME_WINDOW">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">TIME_WINDOW</code><em class="property"> = 8.9</em><a class="headerlink" href="#larndsim.consts.detector.TIME_WINDOW" title="Permalink to this definition">¶</a></dt>
<dd><p>Time window of current response in <span class="math notranslate nohighlight">\(\mu s\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.TPC_BORDERS">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">TPC_BORDERS</code><em class="property"> = array([], shape=(0, 3, 2), dtype=float64)</em><a class="headerlink" href="#larndsim.consts.detector.TPC_BORDERS" title="Permalink to this definition">¶</a></dt>
<dd><p>Borders of each TPC volume in <span class="math notranslate nohighlight">\(cm\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.TPC_OFFSETS">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">TPC_OFFSETS</code><em class="property"> = array([], shape=(0, 3, 2), dtype=float64)</em><a class="headerlink" href="#larndsim.consts.detector.TPC_OFFSETS" title="Permalink to this definition">¶</a></dt>
<dd><p>TPC offsets wrt the origin in <span class="math notranslate nohighlight">\(cm\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.TRAN_DIFF">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">TRAN_DIFF</code><em class="property"> = 8.8e-06</em><a class="headerlink" href="#larndsim.consts.detector.TRAN_DIFF" title="Permalink to this definition">¶</a></dt>
<dd><p>Transverse diffusion coefficient in <span class="math notranslate nohighlight">\(cm^2/\mu s\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.detector.V_DRIFT">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">V_DRIFT</code><em class="property"> = 0.1648</em><a class="headerlink" href="#larndsim.consts.detector.V_DRIFT" title="Permalink to this definition">¶</a></dt>
<dd><p>Drift velocity in <span class="math notranslate nohighlight">\(cm/\mu s\)</span></p>
</dd></dl>

<dl class="function">
<dt id="larndsim.consts.detector.electron_mobility">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">electron_mobility</code><span class="sig-paren">(</span><em class="sig-param">efield</em>, <em class="sig-param">temperature</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.consts.detector.electron_mobility" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculation of the electron mobility w.r.t temperature and electric
field.
.. rubric:: References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://lar.bnl.gov/properties/trans.html">https://lar.bnl.gov/properties/trans.html</a> (summary)</p></li>
<li><p><a class="reference external" href="https://doi.org/10.1016/j.nima.2016.01.073">https://doi.org/10.1016/j.nima.2016.01.073</a> (parameterization)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>efield</strong> (<em>float</em>) – electric field in kV/cm</p></li>
<li><p><strong>temperature</strong> (<em>float</em>) – temperature</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>electron mobility in cm^2/kV/us</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="larndsim.consts.detector.set_detector_properties">
<code class="sig-prename descclassname">larndsim.consts.detector.</code><code class="sig-name descname">set_detector_properties</code><span class="sig-paren">(</span><em class="sig-param">detprop_file</em>, <em class="sig-param">pixel_file</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.consts.detector.set_detector_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>The function loads the detector properties and
the pixel geometry YAML files and stores the constants
as global variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>detprop_file</strong> (<em>str</em>) – detector properties YAML
filename</p></li>
<li><p><strong>pixel_file</strong> (<em>str</em>) – pixel layout YAML filename</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-larndsim.consts.physics"></span><p>Set physics constants</p>
<dl class="data">
<dt id="larndsim.consts.physics.BIRKS_Ab">
<code class="sig-prename descclassname">larndsim.consts.physics.</code><code class="sig-name descname">BIRKS_Ab</code><em class="property"> = 0.8</em><a class="headerlink" href="#larndsim.consts.physics.BIRKS_Ab" title="Permalink to this definition">¶</a></dt>
<dd><p>Recombination <span class="math notranslate nohighlight">\(A_b\)</span> value for the Birks Model</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.physics.BIRKS_kb">
<code class="sig-prename descclassname">larndsim.consts.physics.</code><code class="sig-name descname">BIRKS_kb</code><em class="property"> = 0.0486</em><a class="headerlink" href="#larndsim.consts.physics.BIRKS_kb" title="Permalink to this definition">¶</a></dt>
<dd><p>Recombination <span class="math notranslate nohighlight">\(k_b\)</span> value for the Birks Model in <span class="math notranslate nohighlight">\((kV/cm)(g/cm^2)/MeV\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.physics.BOX_ALPHA">
<code class="sig-prename descclassname">larndsim.consts.physics.</code><code class="sig-name descname">BOX_ALPHA</code><em class="property"> = 0.93</em><a class="headerlink" href="#larndsim.consts.physics.BOX_ALPHA" title="Permalink to this definition">¶</a></dt>
<dd><p>Recombination <span class="math notranslate nohighlight">\(\alpha\)</span> constant for the Box model</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.physics.BOX_BETA">
<code class="sig-prename descclassname">larndsim.consts.physics.</code><code class="sig-name descname">BOX_BETA</code><em class="property"> = 0.207</em><a class="headerlink" href="#larndsim.consts.physics.BOX_BETA" title="Permalink to this definition">¶</a></dt>
<dd><p>Recombination <span class="math notranslate nohighlight">\(\beta\)</span> value for the Box model in <span class="math notranslate nohighlight">\((kV/cm)(g/cm^2)/MeV\)</span></p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.physics.E_CHARGE">
<code class="sig-prename descclassname">larndsim.consts.physics.</code><code class="sig-name descname">E_CHARGE</code><em class="property"> = 1.602e-19</em><a class="headerlink" href="#larndsim.consts.physics.E_CHARGE" title="Permalink to this definition">¶</a></dt>
<dd><p>Electron charge in Coulomb</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.physics.W_ION">
<code class="sig-prename descclassname">larndsim.consts.physics.</code><code class="sig-name descname">W_ION</code><em class="property"> = 2.36e-05</em><a class="headerlink" href="#larndsim.consts.physics.W_ION" title="Permalink to this definition">¶</a></dt>
<dd><p>Average energy expended per ion pair in LAr in <span class="math notranslate nohighlight">\(MeV\)</span> from Phys. Rev. A 10, 1452</p>
</dd></dl>

<span class="target" id="module-larndsim.consts.light"></span><p>Sets ligth-related constants</p>
<dl class="data">
<dt id="larndsim.consts.light.IMPULSE_MODEL">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">IMPULSE_MODEL</code><em class="property"> = array([1, 0])</em><a class="headerlink" href="#larndsim.consts.light.IMPULSE_MODEL" title="Permalink to this definition">¶</a></dt>
<dd><p>Arbitrary input model (normalized to sum of 1)</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.IMPULSE_TICK_SIZE">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">IMPULSE_TICK_SIZE</code><em class="property"> = 0.001</em><a class="headerlink" href="#larndsim.consts.light.IMPULSE_TICK_SIZE" title="Permalink to this definition">¶</a></dt>
<dd><p>Arbitrary input model tick size [microseconds]</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.LIGHT_DET_NOISE_SAMPLE_SPACING">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">LIGHT_DET_NOISE_SAMPLE_SPACING</code><em class="property"> = 0.01</em><a class="headerlink" href="#larndsim.consts.light.LIGHT_DET_NOISE_SAMPLE_SPACING" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample rate for input noise spectrum [microseconds]</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.LIGHT_DIGIT_SAMPLE_SPACING">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">LIGHT_DIGIT_SAMPLE_SPACING</code><em class="property"> = 0.01</em><a class="headerlink" href="#larndsim.consts.light.LIGHT_DIGIT_SAMPLE_SPACING" title="Permalink to this definition">¶</a></dt>
<dd><p>Light waveform sample rate [microseconds]</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.LIGHT_GAIN">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">LIGHT_GAIN</code><em class="property"> = -2.3</em><a class="headerlink" href="#larndsim.consts.light.LIGHT_GAIN" title="Permalink to this definition">¶</a></dt>
<dd><p>Conversion from PE/microsecond to ADC</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.LIGHT_NBIT">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">LIGHT_NBIT</code><em class="property"> = 10</em><a class="headerlink" href="#larndsim.consts.light.LIGHT_NBIT" title="Permalink to this definition">¶</a></dt>
<dd><p>Light digitizer bits</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.LIGHT_OSCILLATION_PERIOD">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">LIGHT_OSCILLATION_PERIOD</code><em class="property"> = 0.095</em><a class="headerlink" href="#larndsim.consts.light.LIGHT_OSCILLATION_PERIOD" title="Permalink to this definition">¶</a></dt>
<dd><p>Reponse oscillation period [microseconds]</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.LIGHT_RESPONSE_TIME">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">LIGHT_RESPONSE_TIME</code><em class="property"> = 0.055</em><a class="headerlink" href="#larndsim.consts.light.LIGHT_RESPONSE_TIME" title="Permalink to this definition">¶</a></dt>
<dd><p>Response RC time [microseconds]</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.LIGHT_TICK_SIZE">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">LIGHT_TICK_SIZE</code><em class="property"> = 0.001</em><a class="headerlink" href="#larndsim.consts.light.LIGHT_TICK_SIZE" title="Permalink to this definition">¶</a></dt>
<dd><p>Step size for light simulation [microseconds]</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.LIGHT_TRIG_THRESHOLD">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">LIGHT_TRIG_THRESHOLD</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#larndsim.consts.light.LIGHT_TRIG_THRESHOLD" title="Permalink to this definition">¶</a></dt>
<dd><p>Total detector light threshold [ADC] (one value for every OP_CHANNEL_PER_TRIG detector sum)</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.LIGHT_TRIG_WINDOW">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">LIGHT_TRIG_WINDOW</code><em class="property"> = (0.9, 1.66)</em><a class="headerlink" href="#larndsim.consts.light.LIGHT_TRIG_WINDOW" title="Permalink to this definition">¶</a></dt>
<dd><p>Light digitization window [microseconds]</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.LIGHT_WINDOW">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">LIGHT_WINDOW</code><em class="property"> = (1, 10)</em><a class="headerlink" href="#larndsim.consts.light.LIGHT_WINDOW" title="Permalink to this definition">¶</a></dt>
<dd><p>Pre- and post-window for light simulation [microseconds]</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.MAX_MC_TRUTH_IDS">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">MAX_MC_TRUTH_IDS</code><em class="property"> = 0</em><a class="headerlink" href="#larndsim.consts.light.MAX_MC_TRUTH_IDS" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of true segments to track for each time tick (<cite>MAX_MC_TRUTH_IDS=0</cite> to disable complete truth tracking)</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.MC_TRUTH_THRESHOLD">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">MC_TRUTH_THRESHOLD</code><em class="property"> = 0.1</em><a class="headerlink" href="#larndsim.consts.light.MC_TRUTH_THRESHOLD" title="Permalink to this definition">¶</a></dt>
<dd><p>Threshold for propogating truth information on a given SiPM</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.OP_CHANNEL_PER_TRIG">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">OP_CHANNEL_PER_TRIG</code><em class="property"> = 6</em><a class="headerlink" href="#larndsim.consts.light.OP_CHANNEL_PER_TRIG" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of SiPMs per detector (used by trigger)</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.SCINT_PRESCALE">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">SCINT_PRESCALE</code><em class="property"> = 1</em><a class="headerlink" href="#larndsim.consts.light.SCINT_PRESCALE" title="Permalink to this definition">¶</a></dt>
<dd><p>Prescale factor analogous to ScintPreScale in LArSoft FIXME</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.SINGLET_FRACTION">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">SINGLET_FRACTION</code><em class="property"> = 0.3</em><a class="headerlink" href="#larndsim.consts.light.SINGLET_FRACTION" title="Permalink to this definition">¶</a></dt>
<dd><p>Fraction of total light emitted from singlet state</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.SIPM_RESPONSE_MODEL">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">SIPM_RESPONSE_MODEL</code><em class="property"> = 0</em><a class="headerlink" href="#larndsim.consts.light.SIPM_RESPONSE_MODEL" title="Permalink to this definition">¶</a></dt>
<dd><p>Set response model type (0=RLC response, 1=arbitrary input)</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.TAU_S">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">TAU_S</code><em class="property"> = 0.001</em><a class="headerlink" href="#larndsim.consts.light.TAU_S" title="Permalink to this definition">¶</a></dt>
<dd><p>Singlet decay time [microseconds]</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.TAU_T">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">TAU_T</code><em class="property"> = 1.53</em><a class="headerlink" href="#larndsim.consts.light.TAU_T" title="Permalink to this definition">¶</a></dt>
<dd><p>Triplet decay time [microseconds]</p>
</dd></dl>

<dl class="data">
<dt id="larndsim.consts.light.W_PH">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">W_PH</code><em class="property"> = 1.95e-05</em><a class="headerlink" href="#larndsim.consts.light.W_PH" title="Permalink to this definition">¶</a></dt>
<dd><p>Ion + excitation work function in <cite>MeV</cite></p>
</dd></dl>

<dl class="function">
<dt id="larndsim.consts.light.set_light_properties">
<code class="sig-prename descclassname">larndsim.consts.light.</code><code class="sig-name descname">set_light_properties</code><span class="sig-paren">(</span><em class="sig-param">detprop_file</em><span class="sig-paren">)</span><a class="headerlink" href="#larndsim.consts.light.set_light_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>The function loads the detector properties YAML file
and stores the light-related constants as global variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>detprop_file</strong> (<em>str</em>) – detector properties YAML filename</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="cli.html" class="btn btn-neutral float-right" title="Command-line utilities" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to larnd-sim’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, DUNE collaboration.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>